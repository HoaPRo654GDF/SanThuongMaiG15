@model SanThuongMaiG15.Models.Product

@{
    ViewData["Title"] = Model.CatId;
    Layout = "~/Views/Shared/_Layout.cshtml";
    List<Product> lsProducts = ViewBag.SanPham;
}

<!-- Begin Main Content Area  -->
<main class="main-content">
    <div class="breadcrumb-area breadcrumb-height" data-bg-image="~/assets/images/breadcrumb/bg/1-1-1920x373.jpg">
        <div class="container h-100">
            <div class="row h-100">
                <div class="col-lg-12">
                    <div class="breadcrumb-item">
                        <h1 class="breadcrumb-heading">@Model.ProductName</h1>
                        <ul>
                            <li>
                                <a asp-controller="Home" asp-action="Index">Trang chủ <i class="pe-7s-angle-right"></i></a>
                            </li>
                            <li>@Model.ProductName</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="single-product-area section-space-top-100">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <div class="single-product-img h-100">
                        <div class="swiper-container single-product-slider">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <a href="~/assets/images/product/@Model.Thumb" class="single-img gallery-popup">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Image">
                                    </a>
                                </div>
                                <div class="swiper-slide">
                                    <a href="~/assets/images/product/@Model.Thumb" class="single-img gallery-popup">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Image">
                                    </a>
                                </div>
                                <div class="swiper-slide">
                                    <a href="~/assets/images/product/@Model.Thumb" class="single-img gallery-popup">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Image">
                                    </a>
                                </div>
                                <div class="swiper-slide">
                                    <a href="~/assets/images/product/@Model.Thumb" class="single-img gallery-popup">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Image">
                                    </a>
                                </div>
                            </div>
                            <!-- Add Pagination -->
                            <div class="swiper-pagination"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="product-thumb-with-content row">
                        <div class="col-12 order-lg-1 order-2 pt-10 pt-lg-0">
                            <div class="single-product-content">
                                <h2 class="title">@Model.ProductName</h2>
                                <div class="price-box pb-1">
                                    <span class="new-price text-danger">@Model.Price.ToString("#,##0") VND</span>
                                    @* <span class="old-price text-primary"></span> *@
                                </div>
                                <div class="rating-box-wrap pb-7">
                                    <div class="rating-box">
                                        <ul>
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                        </ul>
                                    </div>
                                    <div class="review-status ps-4">
                                        <a href="javascript:void(0)"></a>
                                    </div>
                                </div>
                                <p class="short-desc mb-6">
                                   @Model.Description
                                </p>
                                <ul class="quantity-with-btn pb-7">
                                    <li class="quantity">
                                        <div class="cart-plus-minus">
                                            <input id="txtsoluong" name="txtsoluong" class="cart-plus-minus-box" value="1" type="text">
                                        </div>
                                    </li>
                                    <li class="add-to-cart">
                                        <a class="btn btn-custom-size lg-size btn-primary btn-secondary-hover rounded-0" >Thêm giỏ hàng</a>
                                        <input  hidden id="ProductId" asp-for="ProductId" />
                                    </li>
                                </ul>
                                <div class="product-category text-matterhorn pb-2">
                                    <span class="title">Danh mục :</span>
                                    <ul>
                                        <li>
                                            <a href="/@Model.Cat.CatName">@Model.Cat.CatName</a>
                                        </li>
                                       
                                    </ul>
                                </div>
        
                            </div>
                        </div>
                        <div class="col-12 order-lg-2 order-1 pt-10 pt-lg-0">
                            <div class="swiper-container single-product-thumbs">
                                <div class="swiper-wrapper">
                                    <a href="javascript:void(0)" class="swiper-slide">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Thumnail">
                                    </a>
                                    <a href="javascript:void(0)" class="swiper-slide">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Thumnail">
                                    </a>
                                    <a href="javascript:void(0)" class="swiper-slide">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Thumnail">
                                    </a>
                                    <a href="javascript:void(0)" class="swiper-slide">
                                        <img class="img-full" src="~/assets/images/product/@Model.Thumb" alt="Product Thumnail">
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="product-tab-area section-space-top-100">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <ul class="nav product-tab-nav product-tab-style-2" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="active btn btn-custom-size" id="description-tab" data-bs-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="true">
                                Mô tả
                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="btn btn-custom-size" id="reviews-tab" data-bs-toggle="tab" href="#reviews" role="tab" aria-controls="reviews" aria-selected="false">
                                Đánh giá
                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="btn btn-custom-size" id="shipping-tab" data-bs-toggle="tab" href="#shipping" role="tab" aria-controls="shipping" aria-selected="false">
                                Vận chuyển
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content product-tab-content">
                        <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
                            <div class="product-description-body">
                                <p class="short-desc mb-0">
                                    @Model.Description
                                </p>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
                            <div class="product-review-body">
                                <h4 class="heading mb-5">3 Đánh giá </h4>
                                <ul class="user-info-wrap">
                                    <li>
                                        <ul class="user-info">
                                            <li class="user-avatar">
                                                <img src="~/assets/images/testimonial/user/1.png" alt="User Image">
                                            </li>
                                            <li class="user-comment">
                                                <div class="rating-box">
                                                    <ul>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                    </ul>
                                                </div>
                                                <div class="meta">
                                                    <span><strong>TPH -</strong> Ngày 15 tháng 9 năm 2024</span>
                                                </div>
                                                <p class="short-desc mb-0">
                                                    “Giày Nike Air Force 1 là sự kết hợp giữa phong cách cổ điển, sự thoải mái và 
                                                    độ bền, tuy nhiên có thể giá cả cao và trọng lượng hơi nặng so với một số dòng giày khác.“
                                                </p>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <ul class="user-info">
                                            <li class="user-avatar">
                                                <img src="~/assets/images/testimonial/user/1.png" alt="User Image">
                                            </li>
                                            <li class="user-comment">
                                                <div class="rating-box">
                                                    <ul>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                    </ul>
                                                </div>
                                                <div class="meta">
                                                    <span><strong>TPH -</strong> Ngày 15 tháng 9 năm 2024</span>
                                                </div>
                                                <p class="short-desc mb-0">
                                                    “Giày Nike Air Force 1 là sự kết hợp giữa phong cách cổ điển, sự thoải mái và
                                                    độ bền, tuy nhiên có thể giá cả cao và trọng lượng hơi nặng so với một số dòng giày khác.“
                                                </p>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <ul class="user-info">
                                            <li class="user-avatar">
                                                <img src="~/assets/images/testimonial/user/1.png" alt="User Image">
                                            </li>
                                            <li class="user-comment">
                                                <div class="rating-box">
                                                    <ul>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                        <li><i class="pe-7s-star"></i></li>
                                                    </ul>
                                                </div>
                                                <div class="meta">
                                                    <span><strong>TPH -</strong> Ngày 15 tháng 9 năm 2024</span>
                                                </div>
                                                <p class="short-desc mb-0">
                                                    “Giày Nike Air Force 1 là sự kết hợp giữa phong cách cổ điển, sự thoải mái và
                                                    độ bền, tuy nhiên có thể giá cả cao và trọng lượng hơi nặng so với một số dòng giày khác.“
                                                </p>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <div class="feedback-area pt-5">
                                    <h2 class="heading mb-1">Thêm đánh giá</h2>
                                    <p class="short-desc mb-3">Địa chỉ email của bạn sẽ không được công bố.</p>
                                    <div class="rating-box">
                                        <span>Đánh giá của bạn</span>
                                        <ul class="ps-4">
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                            <li><i class="pe-7s-star"></i></li>
                                        </ul>
                                    </div>
                                    <form class="feedback-form pt-8" action="#">
                                        <div class="group-input">
                                            <div class="form-field me-md-6 mb-6 mb-md-0">
                                                <input type="text" name="Họ tên" placeholder="Họ tên" class="input-field">
                                            </div>
                                            <div class="form-field me-md-6 mb-6 mb-md-0">
                                                <input type="text" name="Email" placeholder="Email" class="input-field">
                                            </div>
                                            <div class="form-field">
                                                <input type="text" name="Sđt" placeholder="Sđt" class="input-field">
                                            </div>
                                        </div>
                                        <div class="form-field mt-6">
                                            <textarea name="Lời đánh giá" placeholder="Lời đánh giá" class="textarea-field"></textarea>
                                        </div>
                                        <div class="button-wrap mt-8">
                                            <button type="submit" value="submit" class="btn btn-custom-size lg-size btn-secondary btn-primary-hover btn-lg rounded-0" name="submit">Gửi</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="shipping" role="tabpanel" aria-labelledby="shipping-tab">
                            <div class="product-shipping-body">
                                <h4 class="title">Vận chuyển</h4>
                                <p class="short-desc mb-4">
                                    Sản phẩm sẽ được gửi từ Việt Nam, vì vậy sẽ mất khoảng 2-3 ngày để giao hàng. 
                                    Sản phẩm của chúng tôi có chất lượng tốt với giá cả hợp lý và chúng tôi tin rằng bạn 
                                    sẽ thấy xứng đáng với điều đó. Vì vậy, xin vui lòng kiên nhẫn chờ đợi! Cảm ơn bạn. Nếu có 
                                    bất kỳ câu hỏi nào, xin vui lòng liên hệ với chúng tôi và chúng tôi hứa sẽ nỗ lực hết mình 
                                    để giúp bạn giải quyết vấn đề.
                                </p>
                                <h4 class="title">Về yêu cầu trả hàng</h4>
                                <p class="short-desc mb-4">
                                    Nếu bạn không cần sản phẩm và lo lắng, bạn có thể liên hệ với chúng tôi và chúng tôi sẽ giúp bạn 
                                    giải quyết vấn đề, vì vậy hãy đóng yêu cầu trả hàng! Cảm ơn bạn.
                                </p>
                                <h4 class="title">Đảm bảo</h4>
                                <p class="short-desc mb-0">
                                    Nếu có vấn đề về chất lượng, chúng tôi sẽ gửi lại hoặc hoàn tiền cho bạn, nếu bạn nhận được sản phẩm bị 
                                    hỏng hoặc sai, xin vui lòng liên hệ với chúng tôi và đính kèm một số hình ảnh về sản phẩm, chúng tôi sẽ 
                                    đổi cho bạn một sản phẩm mới chính xác sau khi xác nhận.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="product-slider-area section-space-top-95 section-space-bottom-100">
        <div class="container">
            <div class="section-title text-center pb-55">
                <span class="sub-title text-primary">Có thể bạn thích</span>
                <h2 class="title mb-0">Sản phẩm tương tự</h2>
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="swiper-slider-holder swiper-arrow">
                        <div class="swiper-container product-slider border-issue">
                            <div class="swiper-wrapper">
                                @if(lsProducts != null)
                                {
                                    foreach( var item in lsProducts)
                                    {
                                        string url = $"/{item.ProductName}-{item.ProductId}.html";
                                        <div class="swiper-slide">
                                            <div class="product-item">
                                                <div class="product-img img-zoom-effect">
                                                    <a href="@url">
                                                        <img class="img-full" src="~/assets/images/product/@item.Thumb" alt="Product Images">
                                                    </a>
                                                    <div class="product-add-action">
                                                        <ul>
                                                            <li>
                                                                <a href="cart.html">
                                                                    <i class="pe-7s-cart"></i>
                                                                </a>
                                                            </li> 
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="product-content texx">
                                                    <a class="product-name" href="@url">@item.ProductName</a>
                                                    <div class="price-box pb-1">
                                                        <span class="new-price">@item.Price.ToString("#,##0") VND</span>
                                                    </div>
                                                    <div class="rating-box">
                                                        <ul>
                                                            <li><i class="pe-7s-star"></i></li>
                                                            <li><i class="pe-7s-star"></i></li>
                                                            <li><i class="pe-7s-star"></i></li>
                                                            <li><i class="pe-7s-star"></i></li>
                                                            <li><i class="pe-7s-star"></i></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                        <!-- Add Arrows -->
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<!-- Main Content Area End Here  -->
@section Scripts {
    <script>
        $(document).ready(function () {
            $(".add-to-cart").click(function () {
                var productid = $('#ProductId').val();
                var soLuong = parseInt($('#txtsoluong').val()) || 1;
                if (!productid || soLuong <= 0) {
                    alert("Vui lòng chọn sản phẩm và nhập số lượng hợp lệ.");
                    return;
                }// Sửa lại ID đúng của input số lượng
                $.ajax({
                    url: '/api/cart/add',
                    type: "POST",
                    dataType: "JSON",
                    data: {
                        productID: productid,
                        quantity: soLuong
                    },
                    success: function (response) {
                        if (response.success) {
                            loadHeaderCart(); // Cập nhật giỏ hàng hiển thị
                            location.reload();
                        } else {
                            alert("Có lỗi xảy ra khi thêm sản phẩm vào giỏ hàng.");
                        }
                    },
                    error: function (error) {
                        alert("Có lỗi xảy ra: " + error.responseText);
                    }
                });
            });

            function loadHeaderCart() {
                $("#miniCart").load("/AjaxContent/HeaderCart");
                $("#numberCart").load("/AjaxContent/NumberCart");
            }
        });
    </script>
}
@* @section Scripts {
    <script>
        $(document).ready(function () {
            $(".add-to-cart").click(function () {
                var productid = $('#ProductId').val();
                var soLuong = $('#txtsoluong').val(); // Sửa lại ID đúng của input số lượng
                $.ajax({
                    url: '/api/cart/add',
                    type: "POST",
                    dataType: "JSON",
                    data: {
                        productID: productid,
                        quantity: soLuong
                    },
                    success: function (response) {
                        if (response.success) {
                            loadHeaderCart();
                            location.reload();
                        } else {
                            alert("Có lỗi xảy ra khi thêm sản phẩm vào giỏ hàng.");
                        }
                    },
                    error: function (error) {
                        alert("Có lỗi xảy ra: " + error.responseText);
                    }
                });
            });

            function loadHeaderCart() {
                $("#miniCart").load("/AjaxContent/HeaderCart");
                $("#numberCart").load("/AjaxContent/NumberCart");
            }
        });
    </script>
} *@

@* @section Scripts{
    <script>
        $(document).ready(function () {
            $(function () {
                $(".add-to-cart").click(function () {
                    var productid = $('#ProductId').val();
                    var soluong = $('#txtsoluong').val();
                    $.ajax({
                        url: '/api/cart/add',
                        type: "POST",
                        dataType: "JSON",
                        data: { 
                            productID: productid,
                            quantity: soluong

                        },
                        success: function (response) {
                          
                                loadHeaderCart();// Add Product sucsess
                                // location.reload();
                           
                        },
                        error: function (error) {
                            alert("There was an error posting the data to the server: " + error.responseText);
                        }
                    });
                });
            // });
                function loadHeaderCart() {
                    $("#miniCart").load("/AjaxContent/HeaderCart");
                    $("#numberCart").load("/AjaxContent/NumberCart");
                }
                // $(".removecart").click(function () {
                //     var productid = $(this).attr("data-productid");
                //     $.ajax({
                //         url: "api/cart/remove",
                //         type: "POST",
                //         dataType: "JSON",
                //         data: { productID: productid },
                //         success: function (result) {
                //             if (result.success) {
                //                 loadHeaderCart();//Reload lai gio hang
                //                 location.reload();
                //             }
                //         },
                //         error: function (rs) {
                //             alert("Remove Cart Error !");
                //         }
                //     });
                // });
                // $(".purchase").click(function () {
                //     var productid = parseFloat($(this).attr("data-productid"));
                //     $.ajax({
                //         url: '/api/cart/purchase',
                //         type: "POST",
                //         dataType: "JSON",
                //         data: { productid: productid },
                //         success: function (response) {
                //             window.location = 'checkout.html';
                //             console.log(response); //log to the console to see whether it worked
                //         },
                //         error: function (error) {
                //             alert("There was an error posting the data to the server: " + error.responseText);                                    
                //         });
                //     });


                // });
                // function loadHeaderCart() {
                //     $("#headerCart").load("/AjaxContent/HeaderCart");
                // }

            });
    </script>
} *@